{% extends "base.html" %}

{% block title %}Đổi mật khẩu - Hệ thống Quản lý Nội bộ{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">
                    <i class="bi bi-key"></i> Đổi mật khẩu
                </h4>
            </div>
            <div class="card-body">
                <form method="post" autocomplete="off">
                    <div class="mb-3">
                        <label for="current_password" class="form-label">
                            <i class="bi bi-lock"></i> Mật khẩu hiện tại
                        </label>
                        <input type="password" class="form-control" 
                               id="current_password" name="current_password" 
                               required autofocus autocomplete="off">
                    </div>
                    
                    <div class="mb-3">
                        <label for="new_password" class="form-label">
                            <i class="bi bi-key"></i> Mật khẩu mới
                        </label>
                        <input type="password" class="form-control" 
                               id="new_password" name="new_password" 
                               required minlength="6" autocomplete="off">
                        <div class="form-text">Mật khẩu phải có ít nhất 6 ký tự</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="confirm_password" class="form-label">
                            <i class="bi bi-key-fill"></i> Xác nhận mật khẩu mới
                        </label>
                        <input type="password" class="form-control" 
                               id="confirm_password" name="confirm_password" 
                               required minlength="6" autocomplete="off">
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle"></i> Đổi mật khẩu
                        </button>
                        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                            <i class="bi bi-x-circle"></i> Hủy
                        </a>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="alert alert-info mt-3">
            <i class="bi bi-info-circle"></i>
            <strong>Lưu ý:</strong> Sau khi đổi mật khẩu thành công, bạn sẽ cần đăng nhập lại với mật khẩu mới.
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Real-time password confirmation validation
    const confirmPassword = document.getElementById('confirm_password');
    const newPassword = document.getElementById('new_password');
    
    function checkPasswordMatch() {
        if (confirmPassword.value && newPassword.value) {
            if (confirmPassword.value !== newPassword.value) {
                confirmPassword.setCustomValidity('Mật khẩu xác nhận không khớp!');
                confirmPassword.classList.add('is-invalid');
            } else {
                confirmPassword.setCustomValidity('');
                confirmPassword.classList.remove('is-invalid');
                confirmPassword.classList.add('is-valid');
            }
        }
    }
    
    newPassword.addEventListener('input', checkPasswordMatch);
    confirmPassword.addEventListener('input', checkPasswordMatch);
});
</script>
{% endblock %}

